# Copyright 2022 ETH Zurich and University of Bologna.
# Licensed under the Apache License, Version 2.0, see LICENSE for details.
# SPDX-License-Identifier: Apache-2.0

variables:
  GIT_STRATEGY: clone
  VIVADO: vitis-2020.2 vivado
  PYTHON: /home/huettern/.local/bin/python3.9
  VERIBLE_FMT: /home/huettern/.local/verible-v0.0-807-g10e7c71/bin/verible-verilog-format
  BENDER: '/home/huettern/.cargo/bin/bender'
  ARIANE_SDK: '/home/huettern/git/ariane-sdk'

before_script:
  - ${PYTHON} -m venv .venv
  - source .venv/bin/activate
  - pip install -r python-requirements.txt
  - bender --version
  - ${BENDER} --version

stages:
  - build
  - test
  - package
  - deploy

# Packages and elaborates the vivado IPs where occamy is part of. This ensures
# that the occamy xilinx IP can be elaborated
vivado_ip:
  stage: build
  needs: []
  script:
    - make -C hw/system/occamy/fpga/vivado_ips all

# Testing
bootrom:
  stage: build
  needs: []
  script:
    - make -C hw/system/occamy/fpga/bootrom
