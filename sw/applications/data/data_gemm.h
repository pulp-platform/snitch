// Copyright 2022 ETH Zurich and University of Bologna.
// Licensed under the Apache License, Version 2.0, see LICENSE for details.
// SPDX-License-Identifier: Apache-2.0

#include "layer.h"

layer gemm_l = {.type = GEMM,
                .M = 16,
                .N = 16,
                .K = 16,
                .TA = 0,
                .TB = 1,
                .ALPHA = 0,
                .dtype = FP16};

static __fp16 gemm_A_dram[16][16] = {0.38671875,
                                     1.4716796875,
                                     0.1468505859375,
                                     -1.119140625,
                                     0.6708984375,
                                     -0.203857421875,
                                     1.8515625,
                                     -0.4990234375,
                                     -1.203125,
                                     0.57275390625,
                                     1.033203125,
                                     -0.86376953125,
                                     1.07421875,
                                     -1.220703125,
                                     0.50634765625,
                                     -1.0849609375,
                                     -0.08056640625,
                                     -0.313232421875,
                                     -1.45703125,
                                     0.1373291015625,
                                     -1.548828125,
                                     -1.41796875,
                                     0.642578125,
                                     -0.53369140625,
                                     -1.2578125,
                                     -1.0048828125,
                                     1.1611328125,
                                     0.3349609375,
                                     -1.0302734375,
                                     0.304931640625,
                                     0.7265625,
                                     -0.28564453125,
                                     -0.701171875,
                                     0.0092315673828125,
                                     0.07110595703125,
                                     0.51220703125,
                                     -0.10906982421875,
                                     -0.564453125,
                                     -1.7041015625,
                                     0.53369140625,
                                     -0.1265869140625,
                                     1.455078125,
                                     -0.12469482421875,
                                     -0.0009908676147460938,
                                     -0.9462890625,
                                     0.87353515625,
                                     0.256591796875,
                                     -0.491455078125,
                                     -0.364990234375,
                                     -0.027923583984375,
                                     -0.83203125,
                                     -0.09796142578125,
                                     0.646484375,
                                     -0.91357421875,
                                     1.7275390625,
                                     -1.1728515625,
                                     0.2457275390625,
                                     -1.1220703125,
                                     -0.351318359375,
                                     -1.1181640625,
                                     -0.472412109375,
                                     2.099609375,
                                     0.10614013671875,
                                     0.744140625,
                                     -0.2978515625,
                                     -0.6953125,
                                     -0.10284423828125,
                                     -0.77001953125,
                                     -0.293701171875,
                                     0.10845947265625,
                                     -0.2161865234375,
                                     -3.29296875,
                                     0.283447265625,
                                     -1.2333984375,
                                     0.638671875,
                                     0.316162109375,
                                     -0.498046875,
                                     0.0311126708984375,
                                     -0.451416015625,
                                     0.70849609375,
                                     1.5341796875,
                                     0.236083984375,
                                     0.6728515625,
                                     -0.365478515625,
                                     -2.537109375,
                                     -0.1829833984375,
                                     -0.1688232421875,
                                     -0.201416015625,
                                     -0.452880859375,
                                     -1.552734375,
                                     -0.34228515625,
                                     -0.90380859375,
                                     -0.00745391845703125,
                                     0.0016069412231445312,
                                     -0.427001953125,
                                     1.2275390625,
                                     1.1142578125,
                                     1.66796875,
                                     2.10546875,
                                     -1.6171875,
                                     0.62158203125,
                                     0.580078125,
                                     -0.75146484375,
                                     -1.16015625,
                                     0.60009765625,
                                     1.1826171875,
                                     -0.43798828125,
                                     0.1441650390625,
                                     0.6728515625,
                                     -0.3154296875,
                                     0.5615234375,
                                     -1.265625,
                                     -0.420166015625,
                                     1.06640625,
                                     1.00390625,
                                     -1.2578125,
                                     -1.15625,
                                     -1.4501953125,
                                     0.5302734375,
                                     1.544921875,
                                     0.5712890625,
                                     -1.203125,
                                     1.6875,
                                     0.60498046875,
                                     -0.185546875,
                                     1.2607421875,
                                     -0.1724853515625,
                                     1.2060546875,
                                     0.94677734375,
                                     0.381103515625,
                                     0.53759765625,
                                     -0.018463134765625,
                                     -0.5986328125,
                                     -1.2099609375,
                                     0.11688232421875,
                                     -0.857421875,
                                     0.188232421875,
                                     -0.2149658203125,
                                     -0.346435546875,
                                     0.7412109375,
                                     -1.052734375,
                                     -0.50244140625,
                                     -0.007541656494140625,
                                     1.9482421875,
                                     1.0263671875,
                                     0.49072265625,
                                     0.92822265625,
                                     -0.11822509765625,
                                     0.62890625,
                                     -0.65087890625,
                                     1.8662109375,
                                     -0.67333984375,
                                     1.2509765625,
                                     1.126953125,
                                     -0.90283203125,
                                     -1.64453125,
                                     0.53564453125,
                                     0.01461029052734375,
                                     0.2301025390625,
                                     -0.0560302734375,
                                     0.11773681640625,
                                     0.0838623046875,
                                     1.3427734375,
                                     -0.76416015625,
                                     1.0498046875,
                                     -0.603515625,
                                     1.0849609375,
                                     -0.4560546875,
                                     0.3486328125,
                                     -0.445556640625,
                                     -1.734375,
                                     0.611328125,
                                     0.32568359375,
                                     1.0419921875,
                                     -0.5517578125,
                                     0.59521484375,
                                     1.9931640625,
                                     -1.7060546875,
                                     -0.88525390625,
                                     0.06103515625,
                                     -0.591796875,
                                     0.876953125,
                                     -1.431640625,
                                     -0.65966796875,
                                     -2.0,
                                     -0.02166748046875,
                                     -0.6943359375,
                                     1.9833984375,
                                     0.599609375,
                                     2.380859375,
                                     0.73046875,
                                     0.5625,
                                     0.12310791015625,
                                     -0.405517578125,
                                     -0.77197265625,
                                     -1.66015625,
                                     -0.267578125,
                                     -1.068359375,
                                     1.5390625,
                                     1.7646484375,
                                     -0.64013671875,
                                     0.218017578125,
                                     0.90478515625,
                                     -1.501953125,
                                     1.693359375,
                                     0.0135498046875,
                                     0.461669921875,
                                     -0.71484375,
                                     -1.96484375,
                                     -0.026885986328125,
                                     -1.3671875,
                                     0.410400390625,
                                     0.513671875,
                                     -1.3623046875,
                                     -1.27734375,
                                     0.59765625,
                                     -0.2099609375,
                                     0.73388671875,
                                     -0.724609375,
                                     -0.264404296875,
                                     -0.80322265625,
                                     -1.251953125,
                                     -0.3408203125,
                                     -0.50439453125,
                                     -0.810546875,
                                     0.28857421875,
                                     0.104248046875,
                                     -0.88330078125,
                                     1.984375,
                                     1.142578125,
                                     -0.4619140625,
                                     0.3759765625,
                                     -0.06744384765625,
                                     -0.8515625,
                                     -0.7890625,
                                     -1.498046875,
                                     -1.662109375,
                                     -0.2376708984375,
                                     -0.73681640625,
                                     -0.9169921875,
                                     -0.6689453125,
                                     -2.11328125,
                                     1.45703125,
                                     -0.58203125,
                                     -0.47607421875,
                                     -0.434326171875,
                                     0.8974609375,
                                     -1.0712890625,
                                     -1.5166015625,
                                     -2.484375,
                                     -0.302978515625,
                                     1.5107421875,
                                     1.2919921875,
                                     0.0697021484375,
                                     -1.037109375,
                                     -1.0859375};

static __fp16 gemm_B_dram[16][16] = {1.2109375,
                                     -0.278564453125,
                                     0.292724609375,
                                     -1.0771484375,
                                     -0.3623046875,
                                     1.462890625,
                                     1.091796875,
                                     0.323974609375,
                                     -0.966796875,
                                     2.103515625,
                                     1.333984375,
                                     0.4775390625,
                                     0.34521484375,
                                     -0.236572265625,
                                     0.89404296875,
                                     1.25,
                                     -0.69677734375,
                                     -1.1044921875,
                                     -0.96826171875,
                                     -0.27587890625,
                                     1.978515625,
                                     -0.01094818115234375,
                                     2.443359375,
                                     -0.47314453125,
                                     1.056640625,
                                     0.60986328125,
                                     -1.0634765625,
                                     -0.38232421875,
                                     0.86328125,
                                     0.01087188720703125,
                                     -0.39697265625,
                                     -0.8056640625,
                                     -0.80224609375,
                                     -0.0127716064453125,
                                     1.240234375,
                                     1.5419921875,
                                     -0.308349609375,
                                     0.79443359375,
                                     0.2235107421875,
                                     2.029296875,
                                     -3.146484375,
                                     -0.63232421875,
                                     1.15625,
                                     -2.41015625,
                                     -0.6181640625,
                                     -0.11669921875,
                                     0.476806640625,
                                     -0.81689453125,
                                     -0.6923828125,
                                     1.494140625,
                                     0.57861328125,
                                     -0.7939453125,
                                     -1.4599609375,
                                     -0.869140625,
                                     0.767578125,
                                     -0.351318359375,
                                     0.3837890625,
                                     -1.7041015625,
                                     1.0537109375,
                                     -0.845703125,
                                     1.8662109375,
                                     -1.35546875,
                                     -0.583984375,
                                     -0.7021484375,
                                     0.86181640625,
                                     -0.481689453125,
                                     -0.259521484375,
                                     1.7451171875,
                                     -0.41796875,
                                     -0.98681640625,
                                     0.537109375,
                                     -0.36376953125,
                                     0.07916259765625,
                                     0.024810791015625,
                                     0.52880859375,
                                     0.380615234375,
                                     0.147216796875,
                                     -0.6982421875,
                                     0.0745849609375,
                                     0.408203125,
                                     0.476318359375,
                                     -0.82080078125,
                                     0.01197052001953125,
                                     0.65087890625,
                                     0.96044921875,
                                     1.419921875,
                                     -0.313232421875,
                                     0.607421875,
                                     1.3603515625,
                                     -0.19091796875,
                                     0.393798828125,
                                     -1.4970703125,
                                     -0.32275390625,
                                     -0.0017023086547851562,
                                     0.4599609375,
                                     0.51171875,
                                     -0.7802734375,
                                     -1.55078125,
                                     -0.286865234375,
                                     -1.09375,
                                     -1.29296875,
                                     0.53369140625,
                                     0.86083984375,
                                     0.486328125,
                                     -1.1767578125,
                                     1.4931640625,
                                     -0.783203125,
                                     1.1708984375,
                                     -1.154296875,
                                     2.1640625,
                                     0.2666015625,
                                     0.86376953125,
                                     0.6416015625,
                                     0.2105712890625,
                                     0.1787109375,
                                     0.31494140625,
                                     0.2484130859375,
                                     0.1094970703125,
                                     -1.2587890625,
                                     0.58251953125,
                                     0.87451171875,
                                     0.286865234375,
                                     0.454833984375,
                                     0.17724609375,
                                     0.233154296875,
                                     -0.87255859375,
                                     -0.66552734375,
                                     1.0947265625,
                                     -0.88427734375,
                                     1.7626953125,
                                     -1.7841796875,
                                     0.70458984375,
                                     0.40185546875,
                                     -0.280517578125,
                                     -0.1263427734375,
                                     -1.7587890625,
                                     0.72216796875,
                                     -1.23046875,
                                     -1.8095703125,
                                     1.3359375,
                                     1.474609375,
                                     0.491455078125,
                                     -1.033203125,
                                     -0.159423828125,
                                     -0.603515625,
                                     -1.1826171875,
                                     0.5576171875,
                                     -1.189453125,
                                     0.92822265625,
                                     -2.04296875,
                                     -0.54833984375,
                                     0.22412109375,
                                     0.77880859375,
                                     0.59912109375,
                                     0.2244873046875,
                                     0.9326171875,
                                     -0.82666015625,
                                     -1.05859375,
                                     -0.043975830078125,
                                     -0.430908203125,
                                     1.384765625,
                                     -1.37890625,
                                     -0.1043701171875,
                                     1.099609375,
                                     1.0166015625,
                                     0.3818359375,
                                     1.814453125,
                                     0.0062255859375,
                                     -1.328125,
                                     -0.5244140625,
                                     -2.046875,
                                     -0.238525390625,
                                     -0.72705078125,
                                     1.1181640625,
                                     0.54931640625,
                                     -0.8115234375,
                                     1.388671875,
                                     -1.18359375,
                                     -0.70654296875,
                                     -0.49951171875,
                                     -1.0302734375,
                                     -0.420166015625,
                                     -0.191162109375,
                                     0.1458740234375,
                                     1.1044921875,
                                     -0.60400390625,
                                     -0.09283447265625,
                                     1.421875,
                                     0.149169921875,
                                     -0.9013671875,
                                     -1.0654296875,
                                     -1.0634765625,
                                     -0.134033203125,
                                     -1.177734375,
                                     -0.212646484375,
                                     0.685546875,
                                     -0.1658935546875,
                                     0.5302734375,
                                     0.266357421875,
                                     -0.486572265625,
                                     0.03955078125,
                                     2.67578125,
                                     0.28271484375,
                                     2.3203125,
                                     0.12158203125,
                                     -0.103759765625,
                                     1.5107421875,
                                     0.1676025390625,
                                     -0.3310546875,
                                     -2.005859375,
                                     0.02886962890625,
                                     1.8212890625,
                                     0.61669921875,
                                     -2.041015625,
                                     -1.0048828125,
                                     0.5966796875,
                                     0.2232666015625,
                                     -1.5498046875,
                                     -1.8876953125,
                                     0.3251953125,
                                     -0.36474609375,
                                     -1.1728515625,
                                     0.6083984375,
                                     0.026702880859375,
                                     -1.7138671875,
                                     -0.55322265625,
                                     -0.81787109375,
                                     1.1083984375,
                                     -2.0078125,
                                     -0.389892578125,
                                     -0.0927734375,
                                     -1.0654296875,
                                     -0.44873046875,
                                     0.463134765625,
                                     0.64208984375,
                                     -0.54443359375,
                                     0.96533203125,
                                     0.10626220703125,
                                     0.164306640625,
                                     -0.74658203125,
                                     -1.2119140625,
                                     -0.66357421875,
                                     -0.440673828125,
                                     0.39599609375,
                                     1.64453125,
                                     1.482421875,
                                     -1.62890625,
                                     3.126953125,
                                     -1.63671875,
                                     0.1444091796875,
                                     1.234375,
                                     1.33203125,
                                     -0.76611328125,
                                     -0.50439453125,
                                     2.2421875,
                                     -0.0792236328125};

static __fp16 gemm_C_dram[16][16] = {-1.2568359375,
                                     0.7783203125,
                                     -0.6982421875,
                                     0.64892578125,
                                     -2.234375,
                                     0.339111328125,
                                     1.857421875,
                                     0.06036376953125,
                                     -1.5263671875,
                                     -0.2003173828125,
                                     0.40380859375,
                                     -1.3115234375,
                                     0.435302734375,
                                     -0.83642578125,
                                     0.94921875,
                                     0.8515625,
                                     -1.3125,
                                     -2.794921875,
                                     -0.108642578125,
                                     0.62646484375,
                                     -1.6962890625,
                                     -0.117431640625,
                                     1.87890625,
                                     0.406494140625,
                                     -0.77978515625,
                                     -0.326416015625,
                                     -0.9765625,
                                     -1.0986328125,
                                     1.8017578125,
                                     1.5283203125,
                                     -0.9931640625,
                                     -0.29931640625,
                                     -0.548828125,
                                     0.66455078125,
                                     0.4267578125,
                                     0.734375,
                                     0.005657196044921875,
                                     1.0751953125,
                                     0.7333984375,
                                     -0.07794189453125,
                                     0.94384765625,
                                     0.03875732421875,
                                     0.63916015625,
                                     -0.703125,
                                     1.6572265625,
                                     -0.060943603515625,
                                     2.02734375,
                                     0.1685791015625,
                                     -0.69140625,
                                     2.263671875,
                                     -0.625,
                                     1.2822265625,
                                     0.56494140625,
                                     0.8046875,
                                     -0.19287109375,
                                     -1.7587890625,
                                     0.8984375,
                                     -0.461669921875,
                                     0.361572265625,
                                     0.1983642578125,
                                     -1.119140625,
                                     -1.2587890625,
                                     1.0029296875,
                                     -1.150390625,
                                     -1.0771484375,
                                     0.285888671875,
                                     -0.568359375,
                                     -0.8046875,
                                     0.31103515625,
                                     -0.17138671875,
                                     -1.8974609375,
                                     0.6220703125,
                                     0.6953125,
                                     -0.26318359375,
                                     -0.09356689453125,
                                     0.054290771484375,
                                     1.44921875,
                                     0.54052734375,
                                     0.187744140625,
                                     0.64892578125,
                                     -1.0966796875,
                                     -1.728515625,
                                     -1.0537109375,
                                     -0.86572265625,
                                     0.06195068359375,
                                     -1.1181640625,
                                     -1.0947265625,
                                     -0.9375,
                                     0.53564453125,
                                     0.1744384765625,
                                     0.486328125,
                                     -1.5791015625,
                                     0.00879669189453125,
                                     0.58935546875,
                                     0.78125,
                                     0.261962890625,
                                     -0.916015625,
                                     0.8203125,
                                     -0.438720703125,
                                     0.470458984375,
                                     0.2379150390625,
                                     -1.24609375,
                                     1.8232421875,
                                     -0.9111328125,
                                     1.94140625,
                                     0.3134765625,
                                     0.296875,
                                     -0.419677734375,
                                     -0.82763671875,
                                     -0.2200927734375,
                                     -0.424072265625,
                                     -1.6162109375,
                                     -0.9462890625,
                                     0.62060546875,
                                     -0.33642578125,
                                     -0.787109375,
                                     0.00047779083251953125,
                                     0.85546875,
                                     -1.1875,
                                     -2.291015625,
                                     0.0341796875,
                                     -1.49609375,
                                     -0.059417724609375,
                                     2.01953125,
                                     0.9873046875,
                                     -0.9580078125,
                                     0.9697265625,
                                     -0.68896484375,
                                     -1.23046875,
                                     -1.0693359375,
                                     0.7958984375,
                                     -0.98046875,
                                     -0.1468505859375,
                                     -0.2861328125,
                                     -1.7392578125,
                                     -0.939453125,
                                     -1.3486328125,
                                     -0.6962890625,
                                     -0.0638427734375,
                                     1.478515625,
                                     -0.72216796875,
                                     1.3515625,
                                     1.5302734375,
                                     0.5166015625,
                                     -0.2705078125,
                                     -1.705078125,
                                     1.224609375,
                                     -0.30859375,
                                     -1.8115234375,
                                     -1.5625,
                                     -1.1533203125,
                                     1.1982421875,
                                     0.427490234375,
                                     -2.021484375,
                                     -0.1953125,
                                     -0.2449951171875,
                                     -0.38232421875,
                                     -0.2227783203125,
                                     0.057464599609375,
                                     0.3515625,
                                     0.492919921875,
                                     0.56494140625,
                                     -0.1358642578125,
                                     0.2108154296875,
                                     -0.85986328125,
                                     -0.77392578125,
                                     0.297119140625,
                                     0.333984375,
                                     1.9423828125,
                                     0.96923828125,
                                     1.1591796875,
                                     -0.673828125,
                                     -1.0439453125,
                                     -0.76025390625,
                                     -0.36865234375,
                                     0.64306640625,
                                     -0.11419677734375,
                                     1.8916015625,
                                     -0.52978515625,
                                     0.87451171875,
                                     0.47314453125,
                                     0.3623046875,
                                     -0.70361328125,
                                     -1.330078125,
                                     -0.09246826171875,
                                     -0.72314453125,
                                     0.5537109375,
                                     -1.8203125,
                                     2.1328125,
                                     -1.2080078125,
                                     0.705078125,
                                     0.037689208984375,
                                     0.07220458984375,
                                     3.0234375,
                                     -0.70263671875,
                                     1.05078125,
                                     -0.1131591796875,
                                     -0.515625,
                                     0.90283203125,
                                     0.4853515625,
                                     1.462890625,
                                     -0.349853515625,
                                     0.293212890625,
                                     0.5576171875,
                                     -0.98193359375,
                                     0.30224609375,
                                     -1.806640625,
                                     -0.1812744140625,
                                     0.27392578125,
                                     -1.283203125,
                                     0.53369140625,
                                     0.334716796875,
                                     -0.71826171875,
                                     -0.97705078125,
                                     0.767578125,
                                     -1.556640625,
                                     -0.86328125,
                                     -1.3740234375,
                                     -0.352783203125,
                                     -1.669921875,
                                     -2.3671875,
                                     -0.5498046875,
                                     -0.481689453125,
                                     -0.2001953125,
                                     0.0728759765625,
                                     -0.368408203125,
                                     0.65234375,
                                     -0.06329345703125,
                                     -1.529296875,
                                     1.3896484375,
                                     -1.701171875,
                                     -0.3896484375,
                                     1.71484375,
                                     0.403564453125,
                                     0.06829833984375,
                                     0.08221435546875,
                                     0.9169921875,
                                     0.38916015625,
                                     1.6318359375,
                                     1.3408203125,
                                     -2.01953125,
                                     -0.92724609375,
                                     -0.06500244140625,
                                     0.398681640625,
                                     -0.040496826171875,
                                     -0.32958984375,
                                     0.255615234375,
                                     -0.96728515625,
                                     -1.3779296875,
                                     0.64892578125,
                                     -1.775390625,
                                     -1.10546875,
                                     -0.673828125,
                                     -0.07635498046875,
                                     0.80615234375,
                                     -2.169921875};

static __fp16 gemm_result[16][16] __attribute__((section(".data")));

static __fp16 gemm_checksum[16] = {
    -7.734375, 8.796875,  1.51171875,  -10.7421875, -15.015625, -20.375,
    -29.71875, -19.3125,  -9.734375,   -10.875,     -10.109375, 14.375,
    8.1796875, 12.484375, -14.7890625, 15.421875};
