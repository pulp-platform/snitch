// Copyright 2020 ETH Zurich and University of Bologna.
// Licensed under the Apache License, Version 2.0, see LICENSE for details.
// SPDX-License-Identifier: Apache-2.0
#include <stdint.h>

int main() {
    int errs = 4;

    uint32_t i8a = 0xFFFFFF42;   // 3.14
    uint32_t i16a = 0xFFFF4248;  // 3.14
    float f32a = 3.14;
    double f64a = 3.14;

    double res =
        1.7720045146669350401991125097536315250736085161629429668177719702909929723489025514725611511539091877503688586880283471705309723721012586751956463721779299361108965365785172200533307761033262439251035823876630437358544911321775625334001046371917616395365848355896213899000527657212021528895927246779480097429154300464010005952680240848463115459297328553780312231691503242208599015793499587440362444180066185238563026710308225242753943500300975957184358461499870626091843809846077091336709541509137661458088335053343825975151460070607357734811548345743955015534456467218552322095954133171880799362477308250252188131416973988993582005350715319952451457013468109231195117000461048554576068707669842993562588266797580347406917516902405285501779620381080421964911692468676654496394088290796641726097314467544452471907934937761385072173706953649409390505097456326820687124319479077069857723545275763448424743526123095082523671605076154911770441368544369157939980880039073716064343031720647930305982767909663674127659266536508742233853866486751460736968681734171024601234112111109848603356126829499008554468260892880962422318346551725814678224017826347226250095335499135772956177452621508573027889814601862343733080464610165218611014506469796480839953159053907987963746888229539303938033616475560292508959607852522732628587506900848010359146262337399502719182926411345876346411763682962300200620810946167615503832294702928298154203757353278145481441408173828749702691477702693921981501005117987820425263365883247955854902748660833891001213443228098779002847019799486769225068962106798362492845149943553231162640282955097571324701122433023245811092998880746343360680949191418953273981637109829068110425865251662526085947317016662135990699159458389649426337612397578070919724346301810733843583118526604802387577793788975059774410388320563908349065276980811546400821449562904652037828180265505648380982709553254282570388714170386081582151498563957038798648495307704883419522824305078934219573760102006376672734918202648872366047279461901050575212008546447170395166840447114506461340651090;
    double resf8 = 1.5;

    uint32_t cmp = 0;

    // load smallfloat data into float regfile
    asm volatile(
        "fmv.s.x ft3, %0\n"
        "fmv.s.x ft4, %1\n"
        : "+r"(i8a), "+r"(i16a));

    // FSQRT.D
    asm volatile(
        "fsqrt.d ft5, %0\n"
        "feq.d %2, %1, ft5\n"
        : "+f"(f64a), "+f"(res), "+r"(cmp));

    errs -= (cmp == 0x1);
    cmp = 0;

    // FSQRT.S
    asm volatile(
        "fsqrt.s ft5, %0\n"
        "fcvt.s.d ft6, %1\n"
        "feq.s %2, ft6, ft5\n"
        : "+f"(f32a), "+f"(res), "+r"(cmp));

    errs -= (cmp == 0x1);
    cmp = 0;

    // FSQRT.H
    asm volatile(
        "fsqrt.h ft5, ft4\n"
        "fcvt.h.d ft6, %0\n"
        "feq.h %1, ft6, ft5\n"
        : "+f"(res), "+r"(cmp));

    errs -= (cmp == 0x1);
    cmp = 0;

    // FSQRT.B
    asm volatile(
        "fsqrt.b ft5, ft3\n"
        "fcvt.b.d ft6, %0\n"
        "feq.b %1, ft6, ft5\n"
        : "+f"(resf8), "+r"(cmp));

    errs -= (cmp == 0x1);
    cmp = 0;

    return errs;
}
